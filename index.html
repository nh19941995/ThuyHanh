<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8">
  <title>YÃªu em</title>
  <link href="https://fonts.googleapis.com/css2?family=Josefin+Sans:wght@300;400;600;700&display=swap" rel="stylesheet">
  <style>
    body {
      background-color: #f7d9da;
      margin: 0;
      padding: 0;
      height: 100vh;
      overflow: hidden;
      font-family: 'Josefin Sans', sans-serif;
    }

    .envlope-wrapper {
      height: 380px;
    }

    #envelope {
      margin: 150px;
      position: relative;
      width: 280px;
      height: 180px;
      border-bottom-left-radius: 6px;
      border-bottom-right-radius: 6px;
      margin-left: auto;
      margin-right: auto;
      top: 150px;
      background-color: #f9c5c8;
      box-shadow: 0 4px 20px rgba(0, 0, 0, 0.2);
    }

    .front {
      position: absolute;
      width: 0;
      height: 0;
      z-index: 3;
    }

    .flap {
      border-left: 140px solid transparent;
      border-right: 140px solid transparent;
      border-bottom: 82px solid transparent;
      border-top: 98px solid #ff3333;
      transform-origin: top;
      pointer-events: none;
    }

    .pocket {
      border-left: 140px solid #ff9999;
      border-right: 140px solid #ff9999;
      border-bottom: 90px solid #fd8787;
      border-top: 90px solid transparent;
      border-bottom-left-radius: 6px;
      border-bottom-right-radius: 6px;
    }

    .letter {
      position: relative;
      background-color: #f9c5c8;
      width: 90%;
      margin-left: auto;
      margin-right: auto;
      height: 90%;
      top: 5%;
      border-radius: 6px;
      box-shadow: 0 2px 26px rgba(0, 0, 0, 0.12);
    }

    .letter:after {
      content: "";
      position: absolute;
      top: 0;
      bottom: 0;
      left: 0;
      right: 0;
      background-image: linear-gradient(180deg, rgba(255, 255, 255, 0) 25%, rgba(239, 215, 239, 0.7) 55%, #eed7ef 100%);
    }

    .words {
      position: absolute;
      left: 10%;
      width: 80%;
      height: 14%;
      background-color: #fdb7ba;
    }

    .words.line1 {
      top: 15%;
      width: 20%;
      height: 7%;
    }

    .words.line2 {
      top: 30%;
    }

    .words.line3 {
      top: 50%;
    }

    .words.line4 {
      top: 70%;
    }

    .open .flap {
      transform: rotateX(180deg);
      transition: transform 0.4s ease, z-index 0.6s;
      z-index: 1;
    }

    .close .flap {
      transform: rotateX(0deg);
      transition: transform 0.4s 0.6s ease, z-index 1s;
      z-index: 5;
    }

    .close .letter {
      transform: translateY(0px);
      transition: transform 0.4s ease, z-index 1s;
      z-index: 1;
    }

    .open .letter {
      transform: translateY(-60px);
      transition: transform 0.4s 0.6s ease, z-index 0.6s;
      z-index: 2;
    }

    .hearts {
      position: absolute;
      top: 90px;
      left: 0;
      right: 0;
      z-index: 2;
    }

    .heart {
      position: absolute;
      bottom: 0;
      right: 10%;
      pointer-events: none;
    }

    .heart:before,
    .heart:after {
      position: absolute;
      content: "";
      left: 50px;
      top: 0;
      width: 50px;
      height: 80px;
      background: #D00000;
      border-radius: 50px 50px 0 0;
      transform: rotate(-45deg);
      transform-origin: 0 100%;
      pointer-events: none;
    }

    .heart:after {
      left: 0;
      transform: rotate(45deg);
      transform-origin: 100% 100%;
    }

    .close .heart {
      opacity: 0;
      animation: none;
    }

    .a1 {
      left: 20%;
      transform: scale(0.6);
      opacity: 1;
      animation: slideUp 4s linear 1, sideSway 2s ease-in-out 4 alternate;
      animation-fill-mode: forwards;
      animation-delay: 0.7s;
    }

    .a2 {
      left: 55%;
      transform: scale(1);
      opacity: 1;
      animation: slideUp 5s linear 1, sideSway 4s ease-in-out 2 alternate;
      animation-fill-mode: forwards;
      animation-delay: 0.7s;
    }

    .a3 {
      left: 10%;
      transform: scale(0.8);
      opacity: 1;
      animation: slideUp 7s linear 1, sideSway 2s ease-in-out 6 alternate;
      animation-fill-mode: forwards;
      animation-delay: 0.7s;
    }

    .karaoke-container {
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      z-index: 10;
      pointer-events: none;
      width: 85%;
      max-width: 650px;
      max-height: 75vh;
      padding: 25px;
      text-align: justify;
      background: rgba(255, 255, 255, 0.95);
      border-radius: 20px;
      box-shadow: 0 12px 40px rgba(0, 0, 0, 0.2);
      backdrop-filter: blur(15px);
      border: 2px solid rgba(255, 255, 255, 0.3);
      overflow-y: auto;
    }

    .karaoke-line {
      font-family: 'Arial', sans-serif;
      font-size: 20px;
      font-weight: bold;
      margin: 12px 0;
      min-height: 28px;
      line-height: 1.5;
      opacity: 0;
      transform: translateY(20px);
      transition: opacity 0.5s ease, transform 0.5s ease;
      text-align: justify;
      text-align-last: left;
      hyphens: auto;
      word-spacing: 0.1em;
    }

    .karaoke-line.active {
      opacity: 1;
      transform: translateY(0);
    }

    .karaoke-line.completed {
      opacity: 0.8;
      transform: translateY(0);
    }

    .karaoke-word {
      display: inline-block;
      margin: 0 3px;
      color: #444;
      transition: color 0.3s ease, transform 0.3s ease;
      text-shadow: 1px 1px 2px rgba(0,0,0,0.1);
    }

    .karaoke-word.highlight {
      color: #4facfe;
      transform: scale(1.15);
      text-shadow: 2px 2px 6px rgba(79, 172, 254, 0.4);
      font-weight: 900;
    }

    .karaoke-word.completed {
      color: #667eea;
      text-shadow: 1px 1px 3px rgba(102, 126, 234, 0.3);
    }

    .contact-info {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      padding: 15px;
      border-radius: 12px;
      margin: 15px 0;
      text-align: center;
      box-shadow: 0 4px 15px rgba(102, 126, 234, 0.3);
    }

    .contact-info a {
      color: #ffecd2;
      text-decoration: none;
      font-weight: bold;
      transition: color 0.3s ease;
    }

    .contact-info a:hover {
      color: #ffffff;
      text-shadow: 0 0 10px rgba(255, 255, 255, 0.5);
    }

    .price-highlight {
      background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
      color: white;
      padding: 8px 15px;
      border-radius: 20px;
      display: inline-block;
      font-weight: bold;
      margin: 0 5px;
      box-shadow: 0 4px 15px rgba(245, 87, 108, 0.3);
    }

    .close .karaoke-container {
      opacity: 0;
      visibility: hidden;
    }

    .open .karaoke-container {
      opacity: 1;
      visibility: visible;
    }

    .open .reset {
      opacity: 0;
      visibility: hidden;
      transition: opacity 0.3s ease, visibility 0.3s ease;
    }

    @keyframes slideUp {
      0% {
        top: 0;
      }
      100% {
        top: -600px;
      }
    }

    @keyframes sideSway {
      0% {
        margin-left: 0px;
      }
      100% {
        margin-left: 50px;
      }
    }

    .reset {
      text-align: center;
      position: fixed;
      bottom: 30px;
      left: 50%;
      transform: translateX(-50%);
      z-index: 15;
      opacity: 1;
      visibility: visible;
      transition: opacity 0.3s ease, visibility 0.3s ease;
    }

    .reset button {
      font-weight: 800;
      font-style: normal;
      transition: all 0.1s linear;
      appearance: none;
      background-color: transparent;
      border: solid 2px #ff5757;
      border-radius: 4px;
      color: #ff5757;
      display: inline-block;
      font-size: 14px;
      text-transform: uppercase;
      margin: 5px;
      padding: 10px;
      line-height: 1em;
      text-decoration: none;
      min-width: 120px;
      cursor: pointer;
    }

    .reset button:hover {
      background-color: #fc9d9d;
      color: #a10000;
    }

    .title-glow {
      text-shadow: 0 0 20px rgba(79, 172, 254, 0.8);
      color: #4facfe;
      font-size: 24px;
      font-weight: 900;
    }
  </style>
</head>
<body>

<div class="envlope-wrapper">
  <div id="envelope" class="close">
    <div class="front flap"></div>
    <div class="front pocket"></div>
    <div class="letter">
      <div class="words line1"></div>
      <div class="words line2"></div>
      <div class="words line3"></div>
      <div class="words line4"></div>
    </div>
    <div class="hearts">
      <div class="heart a1"></div>
      <div class="heart a2"></div>
      <div class="heart a3"></div>
    </div>
    <div class="karaoke-container" id="karaokeContainer">
      <!-- Text sáº½ Ä‘Æ°á»£c táº¡o Ä‘á»™ng báº±ng JavaScript -->
    </div>
  </div>
</div>

<!-- Audio element -->
<audio id="backgroundMusic" loop>
  <source src="love.mp3" type="audio/mpeg">
  Your browser does not support the audio element.
</audio>

<div class="reset">
  <button id="open">Má»Ÿ ThÆ° ðŸ’Œ</button>
</div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
<script>
  $(document).ready(function () {
    var envelope = $('#envelope');
    var btn_open = $("#open");
    var karaokeContainer = $('#karaokeContainer');
    var backgroundMusic = document.getElementById('backgroundMusic');
    
    // Set initial volume
    backgroundMusic.volume = 0.7;
    


    // Text content
    var messages = [
      "Gá»­i ThÃºy Háº¡nh cÃ´ báº¡n nhá» cá»§a tÃ´i !",
      "Nhá»¯ng ngÃ y nÃ y cháº¯c háº³n em Ä‘ang cáº£m tháº¥y Ã¡p lá»±c láº¯m Ä‘Ãºng khÃ´ng? " ,
      "Ká»³ thi Ä‘áº¡i há»c Ä‘ang Ä‘áº¿n gáº§n, vÃ  anh biáº¿t em Ä‘ang cá»‘ gáº¯ng háº¿t sá»©c Ä‘á»ƒ trá»Ÿ thÃ nh má»™t Ä‘iá»u dÆ°á»¡ng ",
      "vÃ¬ Æ°á»›c mÆ¡ muá»‘n Ä‘Æ°á»£c chÄƒm sÃ³c cho ngÆ°á»i khÃ¡c, Ä‘Ã³ tháº­t sá»± má»™t Æ°á»›c mÆ¡ ráº¥t Ä‘áº¹p. ",
      "Anh tá»± hÃ o láº¯m, vÃ¬ em Ä‘Ã£ chá»n con Ä‘Æ°á»ng yÃªu thÆ°Æ¡ng vÃ  tá»­ táº¿ nhÆ° váº­y.",
      "Anh biáº¿t cÃ³ nhá»¯ng lÃºc em má»‡t má»i, hoang mang, muá»‘n bá» cuá»™c,",
      "nhÆ°ng mong em Ä‘á»«ng quÃªn lÃ½ do em báº¯t Ä‘áº§u vÃ  dÃ¹ káº¿t quáº£ cÃ³ tháº¿ nÃ o Ä‘i ná»¯a, em Ä‘Ã£ can Ä‘áº£m hÆ¡n ráº¥t nhiá»u ngÆ°á»i rá»“i",
      "vÃ¬ em Ä‘Ã£ dÃ¡m mÆ¡ vÃ  dÃ¡m bÆ°á»›c Ä‘i. CÃ´ báº¡n nhá» Ã , hÃ£y cá»© bÆ°á»›c tiáº¿p nhÃ©",
      "VÃ¬ phÃ­a trÆ°á»›c, dÃ¹ lÃ  khÃ³ khÄƒn hay rá»±c rá»¡",
      "Ä‘Ã³ váº«n sáº½ lÃ  hÃ nh trÃ¬nh mÃ  anh mong Ä‘Æ°á»£c náº¯m tay em Ä‘i cÃ¹ng. ðŸ’•"
    ];

    var currentLineIndex = 0;
    var currentWordIndex = 0;
    var karaokeInterval;
    var isPlaying = false;


    // Music control functions
    function playMusic() {
      backgroundMusic.play().catch((error) => {
        console.log('Auto-play was prevented:', error);
        // Show a message to user that they need to interact first
        alert('Nháº¥n vÃ o thÆ° Ä‘á»ƒ phÃ¡t nháº¡c!');
      });
    }

    function stopMusic() {
      backgroundMusic.pause();
      backgroundMusic.currentTime = 0;
    }
    
  

    var currentLineIndex = 0;
    var currentWordIndex = 0;
    var karaokeInterval;
    var isPlaying = false;

    // Táº¡o HTML cho karaoke
    function createKaraokeHTML() {
      karaokeContainer.empty();
      messages.forEach(function(message, lineIndex) {
        var line = $('<div class="karaoke-line" data-line="' + lineIndex + '"></div>');
        
        // Check if message contains HTML tags
        if (message.includes('<')) {
          line.html(message);
          // For HTML content, we'll treat the whole line as one "word"
          line.attr('data-html', 'true');
        } else {
          var words = message.split(' ');
          words.forEach(function(word, wordIndex) {
            var wordSpan = $('<span class="karaoke-word" data-word="' + wordIndex + '">' + word + '</span>');
            line.append(wordSpan);
          });
        }
        karaokeContainer.append(line);
      });
    }

    // Báº¯t Ä‘áº§u karaoke effect
    function startKaraoke() {
      if (isPlaying) return;
      isPlaying = true;
      currentLineIndex = 0;
      currentWordIndex = 0;
      
      // Hiá»ƒn thá»‹ dÃ²ng Ä‘áº§u tiÃªn
      showCurrentLine();
      
      karaokeInterval = setInterval(function() {
        highlightNextWord();
      }, 400); // Slightly slower for better readability
    }

    // Hiá»ƒn thá»‹ dÃ²ng hiá»‡n táº¡i
    function showCurrentLine() {
      // ÄÃ¡nh dáº¥u dÃ²ng trÆ°á»›c Ä‘Ã³ lÃ  completed
      if (currentLineIndex > 0) {
        $('.karaoke-line[data-line="' + (currentLineIndex - 1) + '"]').removeClass('active').addClass('completed');
      }
      $('.karaoke-line[data-line="' + currentLineIndex + '"]').addClass('active');
      
      // Auto scroll to current line
      var currentLineElement = $('.karaoke-line[data-line="' + currentLineIndex + '"]');
      if (currentLineElement.length) {
        var container = $('#karaokeContainer');
        var scrollTop = currentLineElement.offset().top - container.offset().top + container.scrollTop() - container.height() / 2 + currentLineElement.height() / 2;
        container.animate({scrollTop: scrollTop}, 400);
      }
    }

    // Highlight tá»« tiáº¿p theo
    function highlightNextWord() {
      var currentLine = $('.karaoke-line[data-line="' + currentLineIndex + '"]');
      
      // Check if this is an HTML line
      if (currentLine.attr('data-html') === 'true') {
        // For HTML lines, just show them and move to next line
        setTimeout(function() {
          currentLine.removeClass('active').addClass('completed');
          currentLineIndex++;
          currentWordIndex = 0;
          
          if (currentLineIndex < messages.length) {
            showCurrentLine();
          } else {
            stopKaraoke();
            setTimeout(function() {
              autoReset();
            }, 2000);
          }
        }, 1500); // Show HTML lines longer
        return;
      }
      
      var words = currentLine.find('.karaoke-word');
      
      if (currentWordIndex < words.length) {
        // Highlight tá»« hiá»‡n táº¡i
        $(words[currentWordIndex]).addClass('highlight');
        
        // ÄÃ¡nh dáº¥u tá»« trÆ°á»›c Ä‘Ã³ lÃ  completed
        if (currentWordIndex > 0) {
          $(words[currentWordIndex - 1]).removeClass('highlight').addClass('completed');
        }
        
        currentWordIndex++;
      } else {
        // HoÃ n thÃ nh dÃ²ng hiá»‡n táº¡i
        words.removeClass('highlight').addClass('completed');
        currentLineIndex++;
        currentWordIndex = 0;
        
        if (currentLineIndex < messages.length) {
          // Chuyá»ƒn sang dÃ²ng tiáº¿p theo
          setTimeout(function() {
            showCurrentLine();
          }, 300);
        } else {
          // Káº¿t thÃºc karaoke
          $('.karaoke-line[data-line="' + (currentLineIndex - 1) + '"]').removeClass('active').addClass('completed');
          stopKaraoke();
          setTimeout(function() {
            autoReset();
          }, 2000);
        }
      }
    }

    // Dá»«ng karaoke
    function stopKaraoke() {
      isPlaying = false;
      if (karaokeInterval) {
        clearInterval(karaokeInterval);
      }
    }

    // Reset karaoke
    function resetKaraoke() {
      stopKaraoke();
      $('.karaoke-word').removeClass('highlight completed');
      $('.karaoke-line').removeClass('active completed');
      currentLineIndex = 0;
      currentWordIndex = 0;
      $('#karaokeContainer').scrollTop(0);
    }

    envelope.click(function () {
      open();
    });
    
    btn_open.click(function () {
      open();
    });

    function open() {
      envelope.addClass("open").removeClass("close");
      setTimeout(function() {
        startKaraoke();
        // Start playing music when envelope opens
        playMusic();
      }, 600);
    }

    function close() {
      envelope.addClass("close").removeClass("open");
      resetKaraoke();
      // Stop music when envelope closes
      stopMusic();
    }

    function autoReset() {
      close();
    }

    // Khá»Ÿi táº¡o
    createKaraokeHTML();
  });
</script>

</body>
</html>